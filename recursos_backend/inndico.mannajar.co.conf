
server {
    
    listen                  443 ssl http2;
    listen                  [::]:443 ssl http2;
    server_name             inndico.mannajar.co;
    set                     $base /var/www/ctinu;
    root                    $base;

    # SSL
     ssl_certificate         /etc/letsencrypt/live/inndico.mannajar.co/fullchain.pem;
     ssl_certificate_key     /etc/letsencrypt/live/inndico.mannajar.co/privkey.pem;
     ssl_trusted_certificate /etc/letsencrypt/live/inndico.mannajar.co/chain.pem;

    # security
    include                 nginxconfig.io/security.conf;

    # logging
    access_log              /var/log/nginx/inndico.mannajar.co.access.log;
    error_log               /var/log/nginx/inndico.mannajar.co.error.log warn;

    # index.php
    index                   index.php;

    # index.php fallback
    location / {
        try_files $uri $uri/ /index.php?$query_string;
          #Yoast SEO Sitemaps
        location ~ ([^/]*)sitemap(.*).x(m|s)l$ {
        ## this rewrites sitemap.xml to /sitemap_index.xml
        rewrite ^/sitemap.xml$ /sitemap_index.xml permanent;
        ## this makes the XML sitemaps work
        rewrite ^/([a-z]+)?-?sitemap.xsl$ /index.php?yoast-sitemap-xsl=$1 last;
        rewrite ^/sitemap_index.xml$ /index.php?sitemap=1 last;
        rewrite ^/([^/]+?)-sitemap([0-9]+)?.xml$ /index.php?sitemap=$1&sitemap_n=$2 last;
        ## The following lines are optional for the premium extensions
        ## News SEO
        rewrite ^/news-sitemap.xml$ /index.php?sitemap=wpseo_news last;
        ## Local SEO
        rewrite ^/locations.kml$ /index.php?sitemap=wpseo_local_kml last;
        rewrite ^/geo-sitemap.xml$ /index.php?sitemap=wpseo_local last;
        ## Video SEO
        rewrite ^/video-sitemap.xsl$ /index.php?yoast-sitemap-xsl=video last;
        }
    }
    
        
    # additional config
    include nginxconfig.io/general.conf;
    include nginxconfig.io/wordpress.conf;

    # handle .php
    location ~ \.php$ {
        include nginxconfig.io/php_fastcgi.conf;
    }
}

# non-www, subdomains redirect
server {
    
    listen                  443 ssl http2;
    listen                  [::]:443 ssl http2;
    server_name             *.inndico.mannajar.co;

    # SSL
    ssl_certificate         /etc/letsencrypt/live/inndico.mannajar.co/fullchain.pem;
    ssl_certificate_key     /etc/letsencrypt/live/inndico.mannajar.co/privkey.pem;
    ssl_trusted_certificate /etc/letsencrypt/live/inndico.mannajar.co/chain.pem;
    return                  301 https://inndico.mannajar.co$request_uri;
}


# HTTP redirect
server {
    listen      80;
    listen      [::]:80;
    server_name .inndico.mannajar.co;
    include     nginxconfig.io/letsencrypt.conf;

    location / {
        return 301 https://inndico.mannajar.co$request_uri;
    }
}




 
 
 

 
